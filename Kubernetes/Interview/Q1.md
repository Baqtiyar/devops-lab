## Kubernetes Pod Crashing in Production

### üìå Question:
You‚Äôre alerted that a Kubernetes pod in the `payments` namespace is continuously crashing and restarting. The application is down. You are asked to investigate the issue and bring the service back up. How would you troubleshoot this?

---

### üß† Answer:

To debug a crashing pod, I would follow these steps:

1. **Check the pod status and recent restarts:**
   ```bash
   kubectl get pods -n payments
   ```
   - Look for `CrashLoopBackOff` or high `RESTARTS` count.

2. **Describe the pod for events and errors:**
   ```bash
   kubectl describe pod <pod-name> -n payments
   ```
   - Look for events like:
     - `FailedMount`
     - `Back-off restarting container`
     - `OOMKilled`

3. **Check the container logs:**
   ```bash
   kubectl logs <pod-name> -n payments --previous
   ```
   - This shows logs **before** the crash.
   - Typical issues:
     - Missing env vars
     - ConfigMap or secret not mounted
     - Uncaught exception in app code

4. **Verify configuration:**
   - Check the **Deployment**, **ConfigMap**, **Secrets**, and **Service**:
     ```bash
     kubectl get deploy <deployment-name> -n payments -o yaml
     kubectl get configmap -n payments
     kubectl get secret -n payments
     ```

5. **Check resource limits (CPU/Memory):**
   ```bash
   kubectl describe pod <pod-name> -n payments
   ```
   - If `OOMKilled`, the pod exceeded memory limits.

6. **Manually run the image (optional):**
   - Run the image locally with Docker to reproduce:
     ```bash
     docker run -it <image> /bin/sh
     ```

7. **Apply the fix:**
   - If it‚Äôs config/env-related ‚Üí update the ConfigMap/Secret.
   - If it's code-related ‚Üí coordinate with devs and redeploy.
   - Restart pods after applying:
     ```bash
     kubectl rollout restart deployment <deployment-name> -n payments
     ```

### üîç Common Pod Crash Causes:
- Missing environment variables or secrets
- Crash in entrypoint script or app code
- Liveness/readiness probe failures
- Out-of-memory kills (OOMKilled)
- File/volume mount failures

